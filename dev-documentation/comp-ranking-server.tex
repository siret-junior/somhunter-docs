\chapter{Ranking Server}
\label{comp-ranking-server}

The current ranking server is implemented in Python in the Flask framework. At the start, it loads the image features from the path specified in the \lstinline{CLIP_FEATURES} environment variable. 

Additionally, it requires a dimension of the features in variable \lstinline{CLIP_DIMENSION}. It supports two endpoints: \url{/clip/<query>} and \url{/clip-results/<query>}. The first endpoint takes the query part and embeds it into the CLIP\footnote{https://openai.com/blog/clip/} feature vector space. The second endpoint embeds the query the same way but on top of that, it computes distances to each image feature vector and returns an ordered list of results. It returns only a part of the result (restricted by count in environment variable \lstinline{HOW_MANY_RESULTS}).
